<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Surana Ashok Kumar Arvind Kumar</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{font-family:Arial;background:#f1f8e9;margin:0;padding:10px}
.container{max-width:720px;margin:auto;background:#fff;padding:15px;border-radius:12px}
h2{text-align:center;color:#1b5e20}
label{font-weight:bold;margin-top:10px;display:block}
input,select,textarea,button{
 width:100%;padding:10px;margin-top:5px;font-size:16px
}
.row{display:flex;gap:10px}
.qty{width:100px}
.unit{width:140px}
button{
 background:#2e7d32;color:#fff;border:none;border-radius:25px;
 margin-top:15px;cursor:pointer
}
table{width:100%;margin-top:10px;border-collapse:collapse}
th,td{border:1px solid #ccc;padding:6px;text-align:center}
th{background:#e8f5e9}
</style>
</head>

<body>
<div class="container">

<h2>üõí Surana Ashok Kumar Arvind Kumar</h2>

<label>Name *</label>
<input id="custName">

<label>Mobile *</label>
<input id="custMobile" type="tel" inputmode="numeric"
oninput="this.value=this.value.replace(/[^0-9]/g,'')">

<label>Address *</label>
<textarea id="custAddress"></textarea>

<label>Delivery Type</label>
<select id="deliveryType">
 <option>Home Delivery</option>
 <option>Pick from Shop</option>
</select>

<hr>

<label>Category</label>
<select id="category"></select>

<label>Item</label>
<select id="item"></select>

<label>Quantity</label>
<div class="row">
 <input id="qty" type="number" min="1" value="1" class="qty">
 <select id="unit" class="unit">
  <option value="‡§ï‡§ø‡§≤‡•ã">Kg / ‡§ï‡§ø‡§≤‡•ã</option>
  <option value="‡§ó‡•ç‡§∞‡§æ‡§Æ">Gram / ‡§ó‡•ç‡§∞‡§æ‡§Æ</option>
  <option value="‡§™‡•Ä‡§∏">Piece / ‡§™‡•Ä‡§∏</option>
  <option value="‡§™‡•à‡§ï‡•á‡§ü">Packet / ‡§™‡•à‡§ï‡•á‡§ü</option>
 </select>
</div>

<button id="addBtn">Add Item</button>

<table>
<thead>
<tr><th>Item</th><th>Qty</th><th>‚ùå</th></tr>
</thead>
<tbody id="cartTable"></tbody>
</table>

<button id="orderBtn">Place Order & WhatsApp</button>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getFirestore, collection, getDocs, addDoc }
from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const firebaseConfig = {
 apiKey: "AIzaSyDKzDGac5Zl1RZlZDnkeNZrMf6OGabSiRY",
 authDomain: "mewapeople-25844.firebaseapp.com",
 projectId: "mewapeople-25844",
 storageBucket: "mewapeople-25844.firebasestorage.app",
 messagingSenderId: "53407017674",
 appId: "1:53407017674:web:1667bb04862a76c02a6233"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

let allItems = [];
let cart = [];

const category = document.getElementById("category");
const item = document.getElementById("item");
const cartTable = document.getElementById("cartTable");

async function loadData(){
 const catSnap = await getDocs(collection(db,"categories"));
 category.innerHTML="";
 catSnap.forEach(d=>{
  let c=d.data();
  category.innerHTML+=`<option value="${c.en}">${c.en} / ${c.hi}</option>`;
 });

 const itemSnap = await getDocs(collection(db,"items"));
 allItems = itemSnap.docs.map(d=>d.data());
 loadItems();
}
loadData();

category.addEventListener("change", loadItems);

function loadItems(){
 item.innerHTML="";
 allItems.filter(i=>i.cat===category.value)
 .forEach(i=>{
  item.innerHTML+=`<option value="${i.en}">${i.en} / ${i.hi}</option>`;
 });
}

function addItem(){
 let selected = allItems.find(i=>i.en===item.value);
 if(!selected) return;

 cart.push({
  hi:selected.hi,
  qty:document.getElementById("qty").value,
  unit:document.getElementById("unit").value
 });
 renderCart();
}

function renderCart(){
 cartTable.innerHTML="";
 cart.forEach((c,idx)=>{
  let tr=document.createElement("tr");
  tr.innerHTML=`
   <td>${c.hi}</td>
   <td>${c.qty} ${c.unit}</td>
   <td style="cursor:pointer">‚ùå</td>
  `;
  tr.querySelector("td:last-child")
    .addEventListener("click",()=>removeItem(idx));
  cartTable.appendChild(tr);
 });
}

function removeItem(i){
 cart.splice(i,1);
 renderCart();
}

async function placeOrder(){
 const name = document.getElementById("custName").value.trim();
 const mobile = document.getElementById("custMobile").value.trim();
 const address = document.getElementById("custAddress").value.trim();

 if(!name || !mobile || !address){
  alert("Name, Mobile and Address are mandatory");
  return;
 }

 if(cart.length===0){
  alert("Please add at least one item");
  return;
 }

 const orderCode="ORD"+Date.now();
 const time=new Date().toLocaleString();

 const itemsHindi = cart.map(
  i=>`${i.hi} ${i.qty} ${i.unit}`
 ).join("\n");

 const msg =
`‡§ë‡§∞‡•ç‡§°‡§∞ ‡§®‡§Ç‡§¨‡§∞: ${orderCode}
‡§®‡§æ‡§Æ: ${name}
‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤: ${mobile}
‡§™‡§§‡§æ: ${address}
‡§°‡§ø‡§≤‡•Ä‡§µ‡§∞‡•Ä: ${deliveryType.value}

‡§∏‡§æ‡§Æ‡§æ‡§®:
${itemsHindi}`;

 window.location.href =
 `https://wa.me/919462439993?text=${encodeURIComponent(msg)}`;

 await addDoc(collection(db,"orders"),{
  code:orderCode,
  name:name,
  mobile:mobile,
  address:address,
  type:deliveryType.value,
  items:itemsHindi,
  time:time
 });

 cart=[];
 renderCart();
}

document.getElementById("addBtn")
 .addEventListener("click", addItem);

document.getElementById("orderBtn")
 .addEventListener("click", placeOrder);

</script>

</body>
</html>
