<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Admin Panel - Surana Ashok Kumar Arvind Kumar</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{font-family:Arial;background:#f1f8e9;margin:0;padding:15px}
.container{max-width:1100px;margin:auto;background:#fff;padding:20px;border-radius:12px}
h1{text-align:center;color:#1b5e20}
nav{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:15px}
nav button{padding:10px 15px;border:none;border-radius:20px;background:#2e7d32;color:#fff;cursor:pointer}
section{display:none}
section.active{display:block}
label{font-weight:bold; display:block; margin-top:10px;}
input,select{width:100%;padding:10px;margin-top:5px; box-sizing:border-box; border:1px solid #ccc; border-radius:5px;}
table{width:100%;border-collapse:collapse;margin-top:15px}
th,td{border:1px solid #ccc;padding:10px;text-align:center}
th{background:#e8f5e9}
.delete{color:red;cursor:pointer; font-weight:bold;}
button.action-btn {background:#2e7d32; color:white; padding:12px; width:100%; border:none; border-radius:5px; margin-top:15px; cursor:pointer; font-size:16px;}
</style>
</head>

<body>
<div class="container">

<h1>üõí Admin - Surana Ashok Kumar</h1>

<section id="loginSection" class="active">
<h3>Admin Login</h3>
<input id="adminId" placeholder="Admin ID">
<input id="adminPass" type="password" placeholder="Password">
<button class="action-btn" onclick="login()">Login</button>
</section>

<section id="mainSection">
<nav>
<button onclick="showTab('cat')">Categories</button>
<button onclick="showTab('item')">Items</button>
<button onclick="showTab('orders')">Orders</button>
<button onclick="showTab('cred')">Settings</button>
</nav>

<section id="cred">
<h3>Change Login Credentials</h3>
<input id="newId" placeholder="New Admin ID">
<input id="newPass" placeholder="New Password">
<button class="action-btn" onclick="changeCred()">Update Credentials</button>
</section>

<section id="cat">
<h3>Manage Categories</h3>
<input id="catEn" placeholder="Category (English)">
<input id="catHi" placeholder="Category (Hindi)">
<button class="action-btn" onclick="addCategory()">Add Category</button>
<table>
<thead><tr><th>English</th><th>Hindi</th><th>Action</th></tr></thead>
<tbody id="catTable"></tbody>
</table>
</section>

<section id="item">
<h3>Manage Items</h3>
<label>Select Category</label>
<select id="catSelect"></select>

<label>Item Name (English)</label>
<input id="itemEn" placeholder="e.g. Cashew">

<label>Item Name (Hindi)</label>
<input id="itemHi" placeholder="e.g. ‡§ï‡§æ‡§ú‡•Ç">

<label>Units (Choose up to 2)</label>
<div style="display:flex; gap:10px;">
  <select id="unit1">
    <option value="">-- Select --</option>
    <option value="kg">Kg / ‡§ï‡§ø‡§≤‡•ã</option>
    <option value="gm">Gram / ‡§ó‡•ç‡§∞‡§æ‡§Æ</option>
    <option value="packet">Packet / ‡§™‡•à‡§ï‡•á‡§ü</option>
    <option value="piece">Piece / ‡§™‡•Ä‡§∏</option>
    <option value="litre">litre / ‡§≤‡•Ä‡§ü‡§∞</option>
  </select>
  <select id="unit2">
    <option value="">-- Optional --</option>
    <option value="kg">Kg / ‡§ï‡§ø‡§≤‡•ã</option>
    <option value="gm">Gram / ‡§ó‡•ç‡§∞‡§æ‡§Æ</option>
    <option value="packet">Packet / ‡§™‡•à‡§ï‡•á‡§ü</option>
    <option value="piece">Piece / ‡§™‡•Ä‡§∏</option>
    <option value="litre">litre / ‡§≤‡•Ä‡§ü‡§∞</option>
  </select>
</div>

<div style="display:flex; gap:10px;">
  <div style="flex:1">
    <label>Min Qty</label>
    <input id="minQty" type="number" value="1">
  </div>
  <div style="flex:1">
    <label>Max Qty</label>
    <input id="maxQty" type="number" value="100">
  </div>
</div>

<button class="action-btn" onclick="addItem()">Add Item to Shop</button>

<table>
<thead>
<tr>
<th>Category</th>
<th>English</th>
<th>Hindi</th>
<th>Units</th>
<th>Limits</th>
<th>Action</th>
</tr>
</thead>
<tbody id="itemTable"></tbody>
</table>
</section>

<section id="orders">
<h3>Orders List</h3>
<button onclick="loadOrders()">üîÑ Refresh List</button>
<table>
<thead>
<tr>
<th>Order No</th>
<th>Customer</th>
<th>Mobile</th>
<th>Items</th>
<th>Time</th>
<th>Action</th>
</tr>
</thead>
<tbody id="orderTable"></tbody>
</table>
</section>
</section>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const firebaseConfig = {
 apiKey: "AIzaSyDKzDGac5Zl1RZlZDnkeNZrMf6OGabSiRY",
 authDomain: "mewapeople-25844.firebaseapp.com",
 projectId: "mewapeople-25844",
 storageBucket: "mewapeople-25844.firebasestorage.app",
 messagingSenderId: "53407017674",
 appId: "1:53407017674:web:1667bb04862a76c02a6233"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// LOGIN
window.login = async function(){
 const id = document.getElementById("adminId").value;
 const pass = document.getElementById("adminPass").value;
 try {
  let snap = await getDoc(doc(db,"config","login"));
  if(id === snap.data().id && pass === snap.data().pass){
   document.getElementById("loginSection").style.display="none";
   document.getElementById("mainSection").style.display="block";
   loadAll();
  } else { alert("Wrong Credentials"); }
 } catch(e) { alert("Login Error: " + e.message); }
};

window.changeCred = async function(){
 const id = document.getElementById("newId").value;
 const pass = document.getElementById("newPass").value;
 if(!id || !pass) return alert("Fill both fields");
 await setDoc(doc(db,"config","login"),{id, pass});
 alert("Credentials Updated!");
};

window.showTab = function(id){
 document.querySelectorAll("#mainSection > section").forEach(s=>s.classList.remove("active"));
 document.getElementById(id).classList.add("active");
};

// CATEGORIES
window.addCategory = async function(){
 const en = document.getElementById("catEn").value;
 const hi = document.getElementById("catHi").value;
 if(!en || !hi) return alert("Enter names");
 await addDoc(collection(db,"categories"),{en, hi});
 document.getElementById("catEn").value = "";
 document.getElementById("catHi").value = "";
 loadCategories();
};

async function loadCategories(){
 const catTable = document.getElementById("catTable");
 const catSelect = document.getElementById("catSelect");
 let snap = await getDocs(collection(db,"categories"));
 let list = [];
 snap.forEach(d => list.push({id:d.id, ...d.data()}));
 list.sort((a,b)=> a.en.localeCompare(b.en));

 catTable.innerHTML = "";
 catSelect.innerHTML = "";
 list.forEach(c=>{
  catTable.innerHTML += `<tr><td>${c.en}</td><td>${c.hi}</td><td class="delete" onclick="delCat('${c.id}')">‚ùå</td></tr>`;
  catSelect.innerHTML += `<option value="${c.en}">${c.en} / ${c.hi}</option>`;
 });
}
window.delCat = async (id) => { if(confirm("Delete Category?")){ await deleteDoc(doc(db,"categories",id)); loadCategories(); } };

// ITEMS
window.addItem = async function(){
 try {
  const cat = document.getElementById("catSelect").value;
  const en = document.getElementById("itemEn").value;
  const hi = document.getElementById("itemHi").value;
  const u1 = document.getElementById("unit1").value;
  const u2 = document.getElementById("unit2").value;
  const min = document.getElementById("minQty").value;
  const max = document.getElementById("maxQty").value;

  if(!cat) return alert("Add a category first!");
  if(!en || !hi || !u1) return alert("Missing info");

  const units = [u1, u2].filter(u => u !== "");

  await addDoc(collection(db,"items"), {
   cat: cat, en: en, hi: hi, units: units,
   minQty: Number(min), maxQty: Number(max)
  });

  alert("Success: Item added!");
  document.getElementById("itemEn").value = "";
  document.getElementById("itemHi").value = "";
  loadItems();
 } catch(e) { alert("Error: " + e.message); }
};

async function loadItems(){
 const itemTable = document.getElementById("itemTable");
 let snap = await getDocs(collection(db,"items"));
 let list = [];
 snap.forEach(d => list.push({id:d.id, ...d.data()}));
 list.sort((a,b)=> a.en.localeCompare(b.en));

 itemTable.innerHTML = "";
 list.forEach(i=>{
  itemTable.innerHTML += `<tr>
   <td>${i.cat}</td>
   <td>${i.en}</td>
   <td>${i.hi}</td>
   <td>${(i.units||[]).join(", ")}</td>
   <td>${i.minQty}-${i.maxQty}</td>
   <td class="delete" onclick="delItem('${i.id}')">‚ùå</td>
  </tr>`;
 });
}
window.delItem = async (id) => { if(confirm("Delete Item?")){ await deleteDoc(doc(db,"items",id)); loadItems(); } };

// ORDERS
window.loadOrders = async function(){
 const orderTable = document.getElementById("orderTable");
 let snap = await getDocs(collection(db,"orders"));
 orderTable.innerHTML = "";
 snap.forEach(d=>{
  let o = d.data();
  orderTable.innerHTML += `<tr>
   <td>${o.code}</td>
   <td>${o.name}</td>
   <td>${o.mobile}</td>
   <td><small>${o.items}</small></td>
   <td>${o.time}</td>
   <td class="delete" onclick="delOrder('${d.id}')">‚ùå</td>
  </tr>`;
 });
};
window.delOrder = async (id) => { if(confirm("Remove Order?")){ await deleteDoc(doc(db,"orders",id)); loadOrders(); } };

async function loadAll(){ loadCategories(); loadItems(); loadOrders(); }
</script>

<script src="https://www.google.com/jsapi"></script>
<script>
google.load("elements","1",{packages:"transliteration"});
google.setOnLoadCallback(()=>{
 var control=new google.elements.transliteration.TransliterationControl({
  sourceLanguage:'en', destinationLanguage:['hi'], transliterationEnabled:true
 });
 control.makeTransliteratable(['catHi','itemHi']);
});
</script>

</body>
</html>